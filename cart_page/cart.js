// var duvet_covers = [
//     {
//         name: "MINI FLORAL PRINT DUVET COVER",
//         price: "39.99",
//         ref: "REF. 6102/088",
//         desc: "Duvet cover in 180 thread count cotton percale with a yellow mini floral print.Concealed button fastening at the bottom.",
//         sPrice: "39.99",
//         dPrice: "59.99",
//         main_img: "https://static.zarahome.net/8/photos4/2021/I/4/1/p/6102/088/300/6102088300_7_1_2.jpg?t=1632324449360",
//         img: ["https://static.zarahome.net/8/photos4/2021/I/4/1/p/6102/088/300/6102088300_2_7_1.jpg?t=1632324449360", "https://static.zarahome.net/8/photos4/2021/I/4/1/p/6102/088/300/6102088300_1_1_1.jpg?t=1629302155064", "https://static.zarahome.net/8/photos4/2021/I/4/1/p/6102/088/300/6102088300_2_4_1.jpg?t=1629302155064", "https://static.zarahome.net/8/photos4/2021/I/4/1/p/6102/088/300/6102088300_2_5_1.jpg?t=1629302155064"],
//         r_img: ["https://static.zarahome.net/8/photos4/2021/I/4/1/p/6102/091/300/6102091300_1_1_5.jpg?t=1637655873027", "https://static.zarahome.net/8/photos4/2021/I/4/1/p/6102/089/300/6102089300_1_1_5.jpg?t=1637655873093"],
//         r_name: ["MINI FLORAL PRINT PILLOWCASE", "MINI FLORAL PRINT FLAT SHEET"],
//         r_price: ["10.99", "23.99"],
//         count: 1,
//     },
//     {
//         name: "(180 THREAD COUNT) COTTON PERCALE DUVET COVER",
//         price: "40.00",
//         ref: "REF. 6102/088",
//         desc: "Plain duvet cover in 180 thread count cotton percale.Concealed button fastening at the bottom.JOIN LIFE Care for fiber: at least 50% ecologically grown cotton. Cotton grown using natural fertilisers and pesticides. Moreover, no genetically modified seeds are used during its cultivation, thus helping to preserve seed biodiversity and soil fertility.",
//         sPrice: "35.99",
//         dPrice: "44.99",
//         main_img: "https://static.zarahome.net/8/photos4/2021/I/4/1/p/0105/088/300/0105088300_2_7_1.jpg?t=1630579472761",
//         img: ["https://static.zarahome.net/8/photos4/2021/I/4/1/p/0105/088/300/0105088300_2_7_1.jpg?t=1630579472761", "https://static.zarahome.net/8/photos4/2021/I/4/1/p/0105/088/300/0105088300_1_1_1.jpg?t=1629808013568", "https://static.zarahome.net/8/photos4/2021/I/4/1/p/0105/088/300/0105088300_2_4_1.jpg?t=1629808013568", "https://static.zarahome.net/8/photos4/2021/I/4/1/p/0105/088/300/0105088300_2_5_1.jpg?t=1629808013568"],
//         r_img: ["https://static.zarahome.net/8/photos4/2021/I/4/1/p/0105/089/300/0105089300_1_1_5.jpg?t=1629808012646", "https://static.zarahome.net/8/photos4/2021/I/4/1/p/0105/091/300/0105091300_1_1_5.jpg?t=1630924866348"],
//         r_name: ["(180 THREAD COUNT) COTTON PERCAL", "(180 THREAD COUNT) COTTON PERCALE "],
//         r_price: ["22.99", "10.99"],
//         count: 1,
//     },
//     {
//         name: "FLORAL PRINT DUVET COVER",
//         price: "49.99",
//         ref: "REF. 6102/088",
//         desc: "Duvet cover in 200 thread count cotton percale, with a wild flower print.Concealed button fastening at the bottom.",
//         sPrice: "49.99",
//         dPrice: "59.99",
//         main_img: "https://static.zarahome.net/8/photos4/2021/I/4/1/p/6130/088/727/6130088727_7_1_2.jpg?t=1636474384962",
//         img: ["https://static.zarahome.net/8/photos4/2021/I/4/1/p/6130/088/727/6130088727_2_7_1.jpg?t=1636474384962", "https://static.zarahome.net/8/photos4/2021/I/4/1/p/6130/088/727/6130088727_1_1_1.jpg?t=1629302983793", "https://static.zarahome.net/8/photos4/2021/I/4/1/p/6130/088/727/6130088727_2_4_1.jpg?t=1629302983793", "https://static.zarahome.net/8/photos4/2021/I/4/1/p/6130/088/727/6130088727_2_5_1.jpg?t=1629302983793"],
//         r_img: ["https://static.zarahome.net/8/photos4/2021/I/4/1/p/6130/091/727/6130091727_1_1_5.jpg?t=1637655832688", "https://static.zarahome.net/8/photos4/2021/I/4/1/p/6130/089/727/6130089727_1_1_5.jpg?t=1637655832621"],
//         r_name: ["FLORAL PRINT PILLOWCASE", "FLORAL PRINT FLAT SHEET"],
//         r_price: ["7.99", "49.99"],
//         count: 1,
//     },
//     {
//         name: "BLUE STRIPED LINEN DUVET COVER",
//         price: "79.99",
//         ref: "REF. 6102/088",
//         desc: "Linen duvet cover with contrast dyed thread stripes and button fastening at the bottom.",
//         sPrice: "79.99",
//         dPrice: "89.99",
//         main_img: "https://static.zarahome.net/8/photos4/2021/I/4/1/p/4186/088/400/4186088400_7_1_2.jpg?t=1632836675326",
//         img: ["https://static.zarahome.net/8/photos4/2021/I/4/1/p/4186/088/400/4186088400_2_7_1.jpg?t=1632836675326", "https://static.zarahome.net/8/photos4/2021/I/4/1/p/4186/088/400/4186088400_1_1_1.jpg?t=1621325160190", "https://static.zarahome.net/8/photos4/2021/I/4/1/p/4186/088/400/4186088400_2_4_1.jpg?t=1621325160190", "https://static.zarahome.net/8/photos4/2021/I/4/1/p/4186/088/400/4186088400_2_5_1.jpg?t=1621325160190"],
//         r_img: ["https://static.zarahome.net/8/photos4/2021/I/4/1/p/4186/091/400/4186091400_1_1_5.jpg?t=1637655697705"],
//         r_name: ["STRIPED LINEN PILLOWCASE"],
//         r_price: ["39.99"],
//         count: 1,
//     },
//     {
//         name: "DUVET COVER WITH LINEN EMBROIDERY BORDER",
//         price: "59.99",
//         ref: "REF. 6102/088",
//         desc: "Duvet cover in 200 thread count cotton percale with a linen double border.Concealed button fastening at the bottom.",
//         sPrice: "59.99",
//         dPrice: "69.99",
//         main_img: "https://static.zarahome.net/8/photos4/2021/I/4/1/p/4154/088/250/4154088250_7_1_2.jpg?t=1634571253500",
//         img: ["https://static.zarahome.net/8/photos4/2021/I/4/1/p/4154/088/250/4154088250_2_7_1.jpg?t=1634571253500", "https://static.zarahome.net/8/photos4/2021/I/4/1/p/4154/088/250/4154088250_1_1_1.jpg?t=1618988725014", "https://static.zarahome.net/8/photos4/2021/I/4/1/p/4154/088/250/4154088250_2_4_1.jpg?t=1618988725014", "https://static.zarahome.net/8/photos4/2021/I/4/1/p/4154/088/250/4154088250_2_5_1.jpg?t=1618988725014"],
//         r_img: ["https://static.zarahome.net/8/photos4/2021/I/4/1/p/4154/089/250/4154089250_1_1_5.jpg?t=1637655795994", "https://static.zarahome.net/8/photos4/2021/I/4/1/p/4154/091/250/4154091250_1_1_5.jpg?t=1637655503619"],
//         r_name: ["FLAT SHEET WITH LINEN EMBROIDERY", "PILLOWCASE WITH LINEN EMBROIDERY BO"],
//         r_price: ["39.99", "29.99"],
//         count: 1,
//     },
//     {
//         name: "(160 GSM) WASHED LINEN DUVET COVER",
//         price: "79.99",
//         ref: "REF. 6102/088",
//         desc: "Plain 160 GSM washed linen duvet cover with double topstitching around the edge.Concealed button fastening at the bottom.The washing technique makes the fabric softer and more fluid.JOIN LIFE Care for fiber: 100% European Grown Linen. This linen is produced naturally, without artificial irrigation and no genetically modified seeds or defoliants. It is produced in Europe following the European Flax® standard of the European Confederation of Flax and Hemp (CELC).",
//         sPrice: "69.99",
//         dPrice: "89.99",
//         main_img: "https://static.zarahome.net/8/photos4/2022/V/4/1/p/1150/088/250/1150088250_7_1_2.jpg?t=1631866813313",
//         img: ["https://static.zarahome.net/8/photos4/2022/V/4/1/p/1150/088/250/1150088250_7_1_2.jpg?t=1631866813313", "https://static.zarahome.net/8/photos4/2022/V/4/1/p/1150/088/250/1150088250_1_1_1.jpg?t=1630332476230", "https://static.zarahome.net/8/photos4/2022/V/4/1/p/1150/088/250/1150088250_2_4_1.jpg?t=1630332476230", "https://static.zarahome.net/8/photos4/2022/V/4/1/p/1150/088/250/1150088250_2_5_1.jpg?t=1630332476230"],
//         r_img: ["https://static.zarahome.net/8/photos4/2022/V/4/1/p/1150/089/250/1150089250_1_1_5.jpg?t=1637654689408", "https://static.zarahome.net/8/photos4/2022/V/4/1/p/1150/900/250/1150900250_1_1_5.jpg?t=1637654672824"],
//         r_name: ["(160 GSM) WASHED LINEN FLAT SHEET", "SUITABLE FOR 30 CM DEEP MATTRESSES"],
//         r_price: ["598.99", "44.99"],
//         count: 1,
//     },
// ]

// localStorage.getItem("BAG", JSON.stringify(duvet_covers));
var product = JSON.parse(localStorage.getItem("BAG"));

var prod = document.getElementById("product");
handleDisplayProduct(product);
//   console.log(product)

function handleDisplayProduct(product) {
    //   console.log(product)
    prod.innerHTML = "";

    /* -------------------- DYNAMIC QUANTITY ---------------------------- */

    // var quantity1 = document.getElementById("Item")
    // quantity1.innerHTML = `${product.length} ITEMS`

    // var quantity2 = document.getElementById("basket")
    // quantity2.innerHTML = `SHOPPING BASKET(${product.length})`;

    product.map(function (el, index) {

        var mainDiv = document.createElement("div");
        mainDiv.id = "mainDiv";

        let image = document.createElement("img");
        image.src = el.main_img;
        image.id = "image";

        let title = document.createElement("h4");
        title.innerText = el.name;
        title.id = "title";

        var priceDiv = document.createElement("div");
        priceDiv.id = "priceDiv";
        var iconDiv = document.createElement("div");
        iconDiv.id = "iconDiv";

        let minus = document.createElement("div");
        minus.innerHTML = `<i class="fas fa-minus"></i>`;
        minus.id = "minus";
        minus.addEventListener("click", function () {
            decrement(index, circle, price);
        });

        let circle = document.createElement("div");
        circle.innerText = el.count;
        circle.classList.add("circle");

        let plus = document.createElement("div");
        plus.innerHTML = `<i class="fas fa-plus"></i>`;
        plus.id = "plus";
        plus.addEventListener("click", function () {
            increment(index, circle, price);
        });

        let price = document.createElement("h3");
        let item_total = el.price * el.count;
        price.innerHTML = `${item_total} €`;
        price.id = "price";

        let ref = document.createElement("p");
        ref.innerText = el.ref;
        ref.className = "ref";

        let info = document.createElement("p");
        info.innerText = "double (200 x 200 cm)";
        info.className = "ref"

        let remove = document.createElement("div");
        remove.innerHTML = `<i class="fas fa-times"></i>`;
        remove.id = "remove";
        remove.addEventListener("click", function () {
            makeDelete(index);
        });

        iconDiv.append(minus, circle, plus);

        priceDiv.append(price);

        mainDiv.append(image, remove, title, priceDiv, iconDiv, ref, info);

        // var product = document.getElementById("product") ;
        prod.append(mainDiv);

    });
}

/* ------------------------------ REMOVE FUNCTION -------------------------------- */

function makeDelete(i) {
    // console.log(i)
    product.splice(i, 1);
    localStorage.setItem("BAG", JSON.stringify(product));
    //   location.reload();

    var tCount = 0;
    for (var i = 0; i < product.length; i++) {
        tCount = tCount + product[i].count;
    }
    console.log(tCount);
    localStorage.setItem("countItem", JSON.stringify(tCount));
    document.getElementById("basketCount").innerText = tCount;
    document.querySelector("#Item").innerHTML = `${tCount} ITEMS`;
    document.getElementById("basket").innerHTML = `SHOPPING BASKET(${tCount})`

    var total = product.reduce(function (acc, cv) {
        return acc + Number(cv.price) * (cv.count)

    }, 0);
    // console.log(total) ;
    var p = total.toFixed(2);
    document.querySelector("#total").innerHTML = `<p>${p} €</p>`;
    document.querySelector("#total2").innerHTML = `<h4>${p} €*</h4>`;

    handleDisplayProduct(product);
}

/* ---------------------------- QUANTITY UPDATE(INCREMENT) ------------------------- */
function increment(i, c, p) {
    // console.log(i)
    product[i].count = product[i].count + 1;
    console.log(product)
    // var circle = document.getElementsByClassName("circle") ;
    c.innerHTML = `${product[i].count}`

    p.innerHTML = `${product[i].price * Number(c.innerText)} €`;

    localStorage.setItem("BAG", JSON.stringify(product));

    var total = product.reduce(function (acc, cv) {
        return acc + Number(cv.price) * (cv.count)

    }, 0);
    // console.log(total) ;
    var p = total.toFixed(2);
    document.querySelector("#total").innerHTML = `<p>${p} €</p>`;
    document.querySelector("#total2").innerHTML = `<h4>${p} €*</h4>`;

    var quantity1 = document.getElementById("Item")
    totalCount = 0;
    for (var i = 0; i < product.length; i++) {
        totalCount = totalCount + product[i].count;
    }
    console.log(totalCount)
    quantity1.innerHTML = `${totalCount} ITEMS`
    localStorage.setItem("countItem", JSON.stringify(totalCount));
    document.getElementById("basketCount").innerText = totalCount;

    var quantity2 = document.getElementById("basket")
    quantity2.innerHTML = `SHOPPING BASKET(${totalCount})`
}



/* ---------------------------- QUANTITY UPDATE(DECREMENT) ------------------------- */

function decrement(i, c, p) {
    // console.log(i)

    if (product[i].count > 1) {
        product[i].count = product[i].count - 1;
        console.log(product)
        // var circle = document.getElementsByClassName("circle") ;
        c.innerHTML = `${product[i].count}`

        p.innerHTML = `${product[i].price * Number(c.innerText)} €`;

        localStorage.setItem("BAG", JSON.stringify(product));

        var total = product.reduce(function (acc, cv) {
            return acc + Number(cv.price) * (cv.count);

        }, 0);
        // console.log(total) ;
        var p = total.toFixed(2);
        document.querySelector("#total").innerHTML = `<p>${p} €</p>`;
        document.querySelector("#total2").innerHTML = `<h4>${p} €*</h4>`;

        var quantity1 = document.getElementById("Item")
        var totalCount = 0;
        for (var i = 0; i < product.length; i++) {
            totalCount = totalCount + product[i].count;
        }
        localStorage.setItem("countItem", JSON.stringify(totalCount));
        document.getElementById("basketCount").innerText = totalCount;
        console.log(totalCount)
        quantity1.innerHTML = `${totalCount} ITEMS`

        var quantity2 = document.getElementById("basket")
        quantity2.innerHTML = `SHOPPING BASKET(${totalCount})`
    }
}


// ----------------------  TOTAL PRICE  ----------------------------

var total = product.reduce(function (acc, cv) {
    return acc + Number(cv.price * cv.count);
}, 0);

// console.log(total) ;
var p = total.toFixed(2);
document.querySelector("#total").innerHTML = `<p>${p} €</p>`;
document.querySelector("#total2").innerHTML = `<h4>${p} €*</h4>`;

var totalCount = 0;
for (var i = 0; i < product.length; i++) {
    totalCount = totalCount + product[i].count;
}
console.log(totalCount);
localStorage.setItem("countItem", JSON.stringify(totalCount));
document.querySelector("#Item").innerHTML = `${totalCount} ITEMS`;
document.getElementById("basket").innerHTML = `SHOPPING BASKET(${totalCount})`
// quantity1.innerHTML = `${totalCount} ITEMS`


/*----------------------------------FOR PAYMENT PAGE---------------------------------------*/

var button = document.getElementById("btn")
button.addEventListener("click", function () {
    payment_page()
})


function payment_page() {
    var payment_total = document.getElementById("total2").textContent;
    payment_total = payment_total.slice(0, -3);
    console.log(payment_total)

    var newdata = JSON.parse(localStorage.getItem("BAG"))

    newdata.push(payment_total)

    localStorage.setItem("FROM BAG", JSON.stringify(newdata));

    localStorage.setItem("Total", JSON.stringify(payment_total))

    window.location.href = "../check_pay_summary/checkoutpage/checkout.html";
}



//LOGIN
let loginDisplay = localStorage.getItem("loginDisplay") || null;
console.log(loginDisplay);
if (loginDisplay !== null) {
    document.getElementById("modallogin").innerHTML = loginDisplay;
}

//BASKET
let countItem = localStorage.getItem("countItem") || 0;
document.getElementById("basketCount").innerText = countItem;